# ë¸Œë¼ìš°ì €ì— google.comì„ ì¹˜ë©´ ì¼ì–´ë‚˜ëŠ” ì¼(ìž‘ì„± ì¤‘)

ë¸Œë¼ìš°ì €ì— google.comì„ ì¹˜ê³  ì—”í„°ë¥¼ ì³¤ì„ ë•Œ ì¼ì–´ë‚˜ëŠ” ì¼ì„ ê°œëžµì ìœ¼ë¡œ ì‚´íŽ´ë³´ìž.   
ìµœëŒ€í•œ high-levelë‹¨ì— ë§žì¶° ê°„ëžµížˆ ì •ë¦¬í•˜ë ¤ê³  í–ˆìœ¼ë©°,   
ì¶”ê°€ë¡œ ê³µë¶€í•˜ê¸¸ ì¶”ì²œí•˜ëŠ” ì£¼ì œë“¤ì€ ë³„ë„ë¡œ ì •ë¦¬í•˜ì˜€ë‹¤.   
ì—¬ê¸°ì„œëŠ” ë¸Œë¼ìš°ì € ê²€ìƒ‰ì°½ì— 'google.com'ì„ ë¬¸ìžì—´ ê·¸ëŒ€ë¡œ ìž…ë ¥í•˜ê³  ì—”í„°ë¥¼ ì¹œ ìƒí™©ì„ ê¸°ì¤€ìœ¼ë¡œ ê¸°ìˆ í•œë‹¤. 

---

## 1. URL Parsing
ì—”í„°ë¥¼ ì¹˜ëŠ” ìˆœê°„ ë¸Œë¼ìš°ì €ëŠ” ê²€ìƒ‰ì°½ì˜ ë¬¸ìžì—´ ë¶„ì„ì„ ë©ˆì¶”ê³  ìž…ë ¥ê°’ì´ URLì¸ì§€, ê²€ìƒ‰ì–´ì¸ì§€ë¥¼ ê²°ì •í•œë‹¤.   
ë§Œì•½ ê²€ìƒ‰ì–´ê°€ ì•„ë‹ˆë¼ë©´ ë¸Œë¼ìš°ì €ëŠ” Google í™ˆíŽ˜ì´ì§€ì— ì ‘ì†í•˜ê¸° ìœ„í•œ ìž‘ì—…ì„ ì§„í–‰í•˜ê²Œ ëœë‹¤.   

## 2. HTTP(port 80)? HTTPS(port 443)?
URL íŒŒì‹±ì´ ëë‚œ í›„ ë¸Œë¼ìš°ì €ê°€ ê°€ìž¥ ë¨¼ì €í•˜ëŠ” ì¼ì€ ì–´ë–¤ í”„ë¡œí† ì½œì„ í†µí•´ GET Requestë¥¼ ë³´ë‚¼ ì§€ ê²°ì •í•˜ëŠ” ê²ƒì´ë‹¤.   
ë¸Œë¼ìš°ì €ëŠ” HSTS(HTTP Strict Transport Security)ì—ì„œ ë„ë©”ì¸ì„ ê²€ìƒ‰í•˜ê³    
ê²€ìƒ‰ ê²°ê³¼ì— ë”°ë¼ ì–´ë–¤ í”„ë¡œí† ì½œì„ í†µí•´ ìš”ì²­ì„ ë³´ë‚¼ ì§€ ê²°ì •í•œë‹¤.   
HSTSì—ì„œ ê²€ìƒ‰ë˜ì§€ ì•ŠëŠ”ë‹¤ë©´ Defaultë¡œ HTTP í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.   
> ì¸ìœ„ì ìœ¼ë¡œ HTTPë¥¼ í†µí•´ ìš”ì²­í•  ê²½ìš°
>>![HTTP ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µ](/assets/what-happens/2-http-request-response.png)

## 3. DNS(Domain Name System) Lookup
ì•žì„  ê³¼ì •ë“¤ì„ í†µí•´ ë¸Œë¼ìš°ì €ëŠ” ë„ë©”ì¸ëª…, í”„ë¡œí† ì½œ, port ë²ˆí˜¸ë¥¼ ê²°ì •í–ˆìœ¼ë¯€ë¡œ   
google.comì˜ ì›¹ ì„œë²„ì— ìš”ì²­ì„ ë³´ë‚´ê¸° ìœ„í•´ IP ì£¼ì†Œë¥¼ ì•Œì•„ë‚´ì•¼ í•œë‹¤.   
ê°€ìž¥ ë¨¼ì € ë¸Œë¼ìš°ì €ëŠ” ìžì‹ ì˜ host ìºì‹œë¥¼ í™•ì¸í•˜ê³ ,   
ë§Œì•½ ì—†ë‹¤ë©´ ìš´ì˜ì²´ì œì— í™•ì¸ì„ ìš”ì²­í•œë‹¤.   
ë§Œì•½ ìš´ì˜ì²´ì œì—ì„œë„ IP ì£¼ì†Œë¥¼ ê°€ì§€ê³  ìžˆì§€ ì•Šë‹¤ë©´,   
DNS ì„œë²„ì— ìš”ì²­ì„ ë³´ë‚´ê¸° ìœ„í•´ ë¼ìš°í„°ì— DNS Lookup ìš”ì²­ì„ ë³´ë‚´ê²Œ ëœë‹¤.   
í˜„ëŒ€ì˜ ë¼ìš°í„°ëŠ” ìžì²´ì ìœ¼ë¡œ DNS ì„œë²„ì˜ ê¸°ëŠ¥ì„ í•˜ê¸°ë„ í•˜ë¯€ë¡œ, ìžì‹ ì˜ DNS ìºì‹œë¥¼ ê²€ìƒ‰í•´ë³´ê³    
ê·¸ëž˜ë„ ì—†ë‹¤ë©´ DNS ì„œë²„ì—, DNS ì„œë²„ì—ë„ ì—†ë‹¤ë©´ ISP(Internet Service Provider)ì— ìš”ì²­í•´ IP ì£¼ì†Œë¥¼ ì‘ë‹µìœ¼ë¡œ ë³´ë‚´ì¤€ë‹¤.   
(ISPì˜ DNS ì„œë²„ì—ë„ ì—†ë‹¤ë©´ ìž¬ê·€ì ì¸ íƒìƒ‰ì„ í†µí•´ IP ì£¼ì†Œë¥¼ ì–»ì„ ë•Œê¹Œì§€ DNS ì„œë²„ ë¦¬ìŠ¤íŠ¸ë“¤ì„ ì°¾ì•„ë‹¤ë‹ˆë©° ìš”ì²­í•œë‹¤.)
![DNS Lookupì˜ ê³¼ì •](/assets/what-happens/3-dns-lookup.png)

## 4. TCP Connection
ë¸Œë¼ìš°ì €ëŠ” ì´ì œ ë„ë©”ì¸ì— í•´ë‹¹í•˜ëŠ” IP ì£¼ì†Œë¥¼ ë°”íƒ•ìœ¼ë¡œ TCP ì»¤ë„¥ì…˜ì„ ë§ºê¸° ìœ„í•´ 3-way handshakeë¥¼ ì§„í–‰í•œë‹¤.
TCP Connectionì˜ ì´í•´ì— í•„ìš”í•œ
1. TCP/IP
2. 3-way handshake
3. Routing   
ì€ ì¶”í›„ ë”°ë¡œ ì‚´íŽ´ë³¼ ê²ƒ.   

>![TCP/IP ëª¨ë¸](/assets/what-happens/4.1-osi-tcpip-model.png)
>> ì¶œì²˜: https://www.computernetworkingnotes.com/ccna-study-guide/similarities-and-differences-between-osi-and-tcp-ip-model.html

## 5. TLS(Transport Layer Security)
TCP ì»¤ë„¥ì…˜ì´ ë§ºì–´ì§€ë©´ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ëŠ” ì•ˆì „í•œ í†µì‹ ì„ ìœ„í•´
1. ì§€ì› ê°€ëŠ¥í•œ ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ êµí™˜
2. í‚¤ êµí™˜, ì¸ì¦
3. ëŒ€ì¹­í‚¤ ì•”í˜¸í™” ë° ë©”ì‹œì§€ ì¸ì¦
ì´ë¼ëŠ” 3ë‹¨ê³„ì˜ TLS handshakeê°€ ì¶”ê°€ë¡œ ì§„í–‰ëœë‹¤.(TLS v1.3 ê¸°ì¤€)   
ì´ ê³¼ì •ì—ì„œ ì–´ë–¤ ë²„ì „ì˜ HTTPì„ ì‚¬ìš©í•  ì§€, ì–´ë–¤ ì••ì¶• ë°©ì‹ì„ ì‚¬ìš©í•  ì§€ì— ëŒ€í•œ í•©ì˜ë„ ì´ë£¨ì–´ì§„ë‹¤.

## 6. Client: First GET Request
TLS handshakeê¹Œì§€ ì™„ë£Œë˜ë©´ í´ë¼ì´ì–¸íŠ¸ëŠ” ì„œë²„ì— ì²« GET Requestë¥¼ ë³´ë‚´ê²Œ ëœë‹¤.   
Google ì„œë²„ì—ì„œëŠ” í•´ë‹¹ ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µìœ¼ë¡œ ì›¹íŽ˜ì´ì§€ë¥¼ ë Œë”ë§í•˜ê¸° ìœ„í•œ ìžì›ë“¤ì„ ë³´ë‚´ê²Œ ë˜ê³ ,   
í•´ë‹¹ ìžì›ë“¤ì´ ë„ì°©í•¨ì— ë”°ë¼ ë¸Œë¼ìš°ì €ì—ì„œëŠ” HTML Parsingì„ ì§„í–‰í•œë‹¤.

## 7. Server: Handling Request
HTTPDëŠ” í´ë¼ì´ì–¸íŠ¸ì˜ GET Requestë¥¼ 1) Method 2) Domain(google.com) 3) Pathë¡œ ë¶„ë¦¬í•œë‹¤.
ì´í›„ google.com ë„ë©”ì¸ì— í• ë‹¹ëœ ê°€ìƒ í˜¸ìŠ¤íŠ¸ë¥¼ ì°¾ì•„ GET Requestë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìžˆëŠ” ìƒíƒœì¸ì§€ í™•ì¸í•œë‹¤.
ì²˜ë¦¬ê°€ ê°€ëŠ¥í•œ ìƒíƒœë¼ë©´ ì„œë²„ëŠ” Clientì˜ IP ì£¼ì†Œ, ì¸ì¦ & ê¶Œí•œ ë“±ì„ í™•ì¸í•œ í›„
GET Requestì— í•„ìš”í•œ íŒŒì¼(index.html ë“±)ì„ ì°¾ì•„ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ì†¡í•˜ê²Œ ëœë‹¤.

## 8. HTML Parsing & Rendering
ë¸Œë¼ìš°ì €ëŠ” HTML íŒŒì¼ì„ ì½ì–´ë“¤ì¸ í›„ ë Œë”ë§ì— í•„ìš”í•œ CSS, JS, imageì™€ ê°™ì€ HTML ì™¸ ìš”ì†Œì— ëŒ€í•œ ì¶”ê°€ ìš”ì²­ì„ ì§„í–‰í•œë‹¤.   
ì²« ë²ˆì§¸ GET Requestì™€ëŠ” ë‹¬ë¦¬, HTTP/2ë¶€í„° ì§€ì›í•˜ëŠ” Multiple TCP Connectionì„ í†µí•´ í•œ ë²ˆì— ì—¬ëŸ¬ ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ë„ ìžˆë‹¤. 

## Summary

ë¸Œë¼ìš°ì €ì— 'google.com'ì„ ìž…ë ¥í•˜ê³  ì—”í„°ë¥¼ ì¹˜ëŠ” ìˆœê°„ë¶€í„° ì›¹íŽ˜ì´ì§€ë¥¼ ë Œë”ë§í•˜ëŠ” ê³¼ì •ì„ í¬ê²Œ 8ê°€ì§€ë¡œ ë‚˜ëˆ„ì–´ ì‚´íŽ´ë³´ì•˜ë‹¤.

1. URL Parsing
2. HTTP(port 80)? HTTPS(port 443)? => í”„ë¡œí† ì½œì„ ëª…ì‹œí•˜ì§€ ì•Šì€ ê²½ìš°!
3. DNS Lookup(ë„ë©”ì¸ -> IP ì£¼ì†Œ)
4. TCP Connection(3-way handshake)
5. TLS(Transport Layer Security)
6. Client: First Get Request
7. Server: Handling Request
8. HTML Parsing -> Rendering

ì¶”ê°€ë¡œ ê³µë¶€ë¥¼ í•´ë‚˜ê°€ë©´ì„œ ì‚´ì„ ë¶™ì´ê³  ë‹¨ê³„ë¥¼ ë” ì„¸ë¶„í™”í•´ ë‚˜ê°„ë‹¤ë©´ ë„¤íŠ¸ì›Œí¬ì˜ ì´í•´ ìˆ˜ì¤€ì„ ë†’ì´ëŠ” ë° í° ë„ì›€ì´ ë  ìˆ˜ ìžˆëŠ” ì£¼ì œë¼ê³  ìƒê°í•œë‹¤ ðŸ˜Š

---

> ì°¸ê³  ìžë£Œ
>> Hussein Nasser's youtube: https://www.youtube.com/watch?v=dh406O2v_1c&t=57s    
: Video "What happens when you type google.com into your browser and press enter? (Detailed Analysis)"   

> ë” ì½ì–´ë³´ë©´ ì¢‹ì„ ìžë£Œ
>> alex's github: https://github.com/alex/what-happens-when   
: í•œêµ­ì–´ version: https://github.com/SantonyChoi/what-happens-when-KR   
â— í•´ë‹¹ ë¬¸ì„œì—ì„œëŠ” TLS handshakeë¥¼ 1.2 ë²„ì „ ê¸°ì¤€ìœ¼ë¡œ ê¸°ìˆ í•˜ê³  ìžˆìŒì„ ì°¸ê³ 

> ì¶”ê°€ë¡œ ê³µë¶€í•˜ë©´ ì¢‹ì„ ì£¼ì œë“¤
>> HTTP vs HTTPS(HyperText Transfer Protocol Secure socket layer)   
>> OSI 7 Layer vs TCP/IP Original vs TCP/IP Updated
>> 3-way handshake & 4-way handshake   
>> TCP vs UDP   
>> GET vs POST Method   
>> HTML Rendering   